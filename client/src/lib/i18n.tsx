import React, { createContext, useContext, useState } from 'react';

type Language = 'pt' | 'fr';

type Translations = { [key: string]: { pt: string; fr: string } };

const translations: Translations = {
  dashboard: { pt: 'Painel', fr: 'Tableau de bord' },
  quotes: { pt: 'Orçamentos', fr: 'Devis' },
  materials: { pt: 'Materiais', fr: 'Matériaux' },
  labor: { pt: 'Mão de Obra', fr: "Main d'œuvre" },
  templates: { pt: 'Modelos', fr: 'Modèles' },
  settings: { pt: 'Definições', fr: 'Paramètres' },
  newQuote: { pt: 'Novo Orçamento', fr: 'Nouveau Devis' },
  addMaterial: { pt: 'Adicionar Material', fr: 'Ajouter Matériau' },
  addLabor: { pt: 'Adicionar Mão de Obra', fr: "Ajouter Main d'œuvre" },
  addSection: { pt: 'Adicionar Secção', fr: 'Ajouter Section' },
  addItem: { pt: 'Adicionar Item', fr: 'Ajouter Article' },
  search: { pt: 'Pesquisar...', fr: 'Rechercher...' },
  save: { pt: 'Guardar', fr: 'Sauvegarder' },
  saveDraft: { pt: 'Guardar Rascunho', fr: 'Enregistrer Brouillon' },
  cancel: { pt: 'Cancelar', fr: 'Annuler' },
  edit: { pt: 'Editar', fr: 'Modifier' },
  delete: { pt: 'Eliminar', fr: 'Supprimer' },
  duplicate: { pt: 'Duplicar', fr: 'Dupliquer' },
  back: { pt: 'Voltar', fr: 'Retour' },
  logout: { pt: 'Sair', fr: 'Déconnexion' },
  confirm: { pt: 'Confirmar', fr: 'Confirmer' },
  close: { pt: 'Fechar', fr: 'Fermer' },
  view: { pt: 'Ver', fr: 'Voir' },
  manualItem: { pt: 'Item Manual', fr: 'Article Manuel' },
  fromCatalog: { pt: 'Do Catálogo', fr: 'Du Catalogue' },
  fromLabor: { pt: 'Mão de Obra', fr: "Main d'œuvre" },
  applyTemplate: { pt: 'Aplicar Modelo', fr: 'Appliquer Modèle' },
  exportPDF: { pt: 'Exportar PDF', fr: 'Exporter PDF' },
  sendEmail: { pt: 'Enviar Email', fr: 'Envoyer Email' },
  markAsSent: { pt: 'Marcar Enviado', fr: 'Marquer Envoyé' },
  saveAsTemplate: { pt: 'Guardar como Modelo', fr: 'Sauver comme Modèle' },
  generateAI: { pt: 'Gerar com IA', fr: "Générer avec l'IA" },
  aiComingSoon: { pt: 'Em breve', fr: 'Bientôt' },
  client: { pt: 'Cliente', fr: 'Client' },
  clientName: { pt: 'Nome do Cliente', fr: 'Nom du Client' },
  address: { pt: 'Morada', fr: 'Adresse' },
  workAddress: { pt: 'Morada da Obra', fr: 'Adresse du Chantier' },
  email: { pt: 'Email', fr: 'Email' },
  phone: { pt: 'Telefone', fr: 'Téléphone' },
  status: { pt: 'Estado', fr: 'Statut' },
  total: { pt: 'Total', fr: 'Total' },
  date: { pt: 'Data', fr: 'Date' },
  createdAt: { pt: 'Criado em', fr: 'Créé le' },
  validUntil: { pt: 'Válido até', fr: "Valide jusqu'au" },
  name: { pt: 'Nome', fr: 'Nom' },
  category: { pt: 'Categoria', fr: 'Catégorie' },
  unit: { pt: 'Unidade', fr: 'Unité' },
  cost: { pt: 'Custo', fr: 'Coût' },
  price: { pt: 'Preço', fr: 'Prix' },
  sellPrice: { pt: 'Preço Venda', fr: 'Prix Vente' },
  supplier: { pt: 'Fornecedor', fr: 'Fournisseur' },
  reference: { pt: 'Referência', fr: 'Référence' },
  trade: { pt: 'Ofício', fr: 'Métier' },
  priceLux: { pt: 'Preço LUX', fr: 'Prix LUX' },
  pricePt: { pt: 'Preço PT', fr: 'Prix PT' },
  description: { pt: 'Descrição', fr: 'Description' },
  quantity: { pt: 'Quantidade', fr: 'Quantité' },
  unitPrice: { pt: 'Preço Unit.', fr: 'Prix Unit.' },
  subtotal: { pt: 'Subtotal', fr: 'Sous-total' },
  subtotalMaterials: { pt: 'Subtotal Materiais', fr: 'Sous-total Matériaux' },
  subtotalLabor: { pt: 'Subtotal Mão de Obra', fr: "Sous-total Main d'œuvre" },
  discount: { pt: 'Desconto', fr: 'Remise' },
  iva: { pt: 'IVA', fr: 'TVA' },
  draft: { pt: 'Rascunho', fr: 'Brouillon' },
  sent: { pt: 'Enviado', fr: 'Envoyé' },
  accepted: { pt: 'Aceite', fr: 'Accepté' },
  rejected: { pt: 'Rejeitado', fr: 'Refusé' },
  notes: { pt: 'Notas', fr: 'Notes' },
  paymentConditions: { pt: 'Condições de Pagamento', fr: 'Conditions de Paiement' },
  executionTimeframe: { pt: 'Prazo de Execução', fr: "Délai d'Exécution" },
  validity: { pt: 'Validade', fr: 'Validité' },
  days: { pt: 'dias', fr: 'jours' },
  actions: { pt: 'Ações', fr: 'Actions' },
  overview: { pt: 'Visão Geral', fr: "Vue d'ensemble" },
  activeValue: { pt: 'Valor Ativo', fr: 'Valeur Active' },
  conversionRate: { pt: 'Taxa de Conversão', fr: 'Taux de Conversion' },
  avgQuoteValue: { pt: 'Valor Médio', fr: 'Valeur Moyenne' },
  recentQuotes: { pt: 'Orçamentos Recentes', fr: 'Devis Récents' },
  quickActions: { pt: 'Ações Rápidas', fr: 'Actions Rapides' },
  totalQuotes: { pt: 'Total Orçamentos', fr: 'Total Devis' },
  fromLastMonth: { pt: 'do mês anterior', fr: 'du mois dernier' },
  viewAll: { pt: 'Ver Todos', fr: 'Voir Tout' },
  companyInfo: { pt: 'Informação da Empresa', fr: "Information de l'Entreprise" },
  companyInfoDesc: { pt: 'Aparece nos orçamentos e PDFs.', fr: 'Apparaît sur vos devis et PDFs.' },
  companyName: { pt: 'Nome da Empresa', fr: "Nom de l'Entreprise" },
  taxId: { pt: 'NIF / ID Fiscal', fr: 'NIF / ID Fiscal' },
  quoteDefaults: { pt: 'Predefinições', fr: 'Paramètres par Défaut' },
  quoteDefaultsDesc: { pt: 'Configurações para novos orçamentos.', fr: 'Paramètres pour les nouveaux devis.' },
  defaultVat: { pt: 'IVA Padrão (%)', fr: 'TVA par Défaut (%)' },
  defaultValidity: { pt: 'Validade Padrão', fr: 'Validité par Défaut' },
  defaultPayment: { pt: 'Condições de Pagamento', fr: 'Conditions de Paiement' },
  defaultMargin: { pt: 'Margem Padrão (%)', fr: 'Marge par Défaut (%)' },
  defaultExecution: { pt: 'Prazo de Execução', fr: "Délai d'Exécution" },
  quotePrefix: { pt: 'Prefixo Orçamento', fr: 'Préfixe Devis' },
  footerNote: { pt: 'Nota Rodapé PDF', fr: 'Note Bas de Page' },
  primaryMarket: { pt: 'Mercado Principal', fr: 'Marché Principal' },
  luxembourg: { pt: 'Luxemburgo', fr: 'Luxembourg' },
  portugal: { pt: 'Portugal', fr: 'Portugal' },
  saveChanges: { pt: 'Guardar Alterações', fr: 'Enregistrer' },
  settingsSaved: { pt: 'Definições guardadas.', fr: 'Paramètres enregistrés.' },
  currency: { pt: 'Moeda', fr: 'Devise' },
  uploadLogo: { pt: 'Carregar Logótipo', fr: 'Télécharger Logo' },
  noQuotes: { pt: 'Ainda não tem orçamentos', fr: 'Aucun devis' },
  noQuotesDesc: { pt: 'Crie o primeiro orçamento para começar', fr: 'Créez votre premier devis' },
  noMaterials: { pt: 'Sem materiais', fr: 'Aucun matériau' },
  noMaterialsDesc: { pt: 'Adicione materiais ao catálogo', fr: 'Ajoutez des matériaux' },
  noLabor: { pt: 'Sem mão de obra', fr: "Aucune main d'œuvre" },
  noLaborDesc: { pt: 'Adicione mão de obra', fr: "Ajoutez de la main d'œuvre" },
  noResults: { pt: 'Nenhum resultado', fr: 'Aucun résultat' },
  manageMaterials: { pt: 'Gerir catálogo de materiais e preços.', fr: 'Gérer le catalogue et prix.' },
  manageLabor: { pt: 'Gerir tabela de preços por ofício.', fr: 'Gérer les tarifs par métier.' },
  manageTemplates: { pt: 'Modelos reutilizáveis para orçamentos.', fr: 'Modèles réutilisables.' },
  manageQuotes: { pt: 'Gerir e criar orçamentos.', fr: 'Gérer et créer des devis.' },
  allCategories: { pt: 'Todas', fr: 'Toutes' },
  systemTemplate: { pt: 'Sistema', fr: 'Système' },
  customTemplate: { pt: 'Personalizado', fr: 'Personnalisé' },
  sections: { pt: 'secções', fr: 'sections' },
  newTemplate: { pt: 'Novo Modelo', fr: 'Nouveau Modèle' },
  templateApplied: { pt: 'Modelo aplicado.', fr: 'Modèle appliqué.' },
  quoteCreated: { pt: 'Orçamento criado.', fr: 'Devis créé.' },
  quoteUpdated: { pt: 'Orçamento atualizado.', fr: 'Devis mis à jour.' },
  quoteDeleted: { pt: 'Orçamento eliminado.', fr: 'Devis supprimé.' },
  materialAdded: { pt: 'Material adicionado.', fr: 'Matériau ajouté.' },
  materialDeleted: { pt: 'Material eliminado.', fr: 'Matériau supprimé.' },
  laborAdded: { pt: 'Mão de obra adicionada.', fr: "Main d'œuvre ajoutée." },
  laborDeleted: { pt: 'Mão de obra eliminada.', fr: "Main d'œuvre supprimée." },
  pdfGenerated: { pt: 'PDF gerado.', fr: 'PDF généré.' },
  quoteDocument: { pt: 'ORÇAMENTO', fr: 'DEVIS' },
  documentGeneratedBy: { pt: 'Documento gerado por OrçaPro', fr: 'Document généré par OrçaPro' },
  deleteConfirm: { pt: 'Tem a certeza?', fr: 'Êtes-vous sûr ?' },
  deleteConfirmDesc: { pt: 'Ação irreversível.', fr: 'Action irréversible.' },
  required: { pt: 'Obrigatório', fr: 'Obligatoire' },
  loading: { pt: 'A carregar...', fr: 'Chargement...' },
  error: { pt: 'Erro', fr: 'Erreur' },
  success: { pt: 'Sucesso', fr: 'Succès' },
  items: { pt: 'itens', fr: 'articles' },
  type: { pt: 'Tipo', fr: 'Type' },
  suggest: { pt: 'Sugerir', fr: 'Suggérer' },
};

type LanguageContextType = {
  language: Language;
  setLanguage: (lang: Language) => void;
  t: (key: string) => string;
};

const LanguageContext = createContext<LanguageContextType | undefined>(undefined);

export function LanguageProvider({ children }: { children: React.ReactNode }) {
  const [language, setLanguage] = useState<Language>('pt');
  const t = (key: string) => translations[key]?.[language] ?? key;

  return (
    <LanguageContext.Provider value={{ language, setLanguage, t }}>
      {children}
    </LanguageContext.Provider>
  );
}

export function useLanguage() {
  const context = useContext(LanguageContext);
  if (!context) throw new Error('useLanguage must be used within LanguageProvider');
  return context;
}
